# 9.7 应用泰勒展开的实例

很多人可能对学习泰勒展开的目的感到困惑，因为它们可能很难理解。然而，本章旨在展示泰勒公式的非凡威力。

我们可以采用哪些方法来求函数的极限？极限运算（二次+复合）？代入法？等价无穷小法？都不是！实际上，一旦掌握了泰勒公式，就不需要再学习这些方法了。你将不再需要使用它们！使用这些方法可能会导致错误，如果出现错误，你将不知道出错的地方！

## 泰勒公式的介绍

### 多项式的极限

当涉及到求极限时，处理类似 $e^x$、$\sin(x)$ 或 $\ln(1+x)$ 这样的函数通常会很具挑战性。它们可能看起来相当令人困惑。然而，有一种函数类型在求极限时非常友好，那就是多项式！

多项式的一般公式为：
$$
a_nx^n+a_{n-1}x^{n-1}+\cdots+a_2x^2+a_1x+a_0=\sum_{i=0}^{n}a_ix^i
$$
其中 $a_i$ 是常数，$a_n \neq 0$。

多项式的加法和减法很简单，只需将对应项的系数相加或相减即可。多项式的乘法和除法稍微复杂一些，但是在求极限 $\lim_{x \to \infty}$ 时，有一个容易理解的结论：

考虑两个多项式相除时的极限：
$$
L=\lim_{x \to 0} \frac{a_mx^m+a_{m+1}x^{m+1}+\cdots}{b_nx^n+b_{n+1}x^{n+1}+\cdots} , \quad (a_mb_n \neq 0)
$$
这个极限的结果取决于指数 $m$ 和 $n$ 之间的关系：

- 如果 $m > n$，也就是说，分子是高阶无穷小，比分母更快趋于0，结果为 $L = 0$。
- 如果 $m < n$，也就是说，分子是低阶无穷小，而分母比分子更快趋于0，结果为 $L=\infty$。
- 如果 $m=n$，也就是说，分子和分母是相同阶的无穷小，你可以得到：

$$
L=\lim_{x \to \infty} \frac{(a_mx^m+a_{m+1}x^{m+1}+\cdots)/x^m}{(b_mx^n+b_{m+1}x^{m+1}+\cdots)/x^m}=\lim_{x \to 0} \frac{a_mx^m+a_{m+1}x+\cdots}{b_mx^n+b_{m+1}x+\cdots}=\frac{a_m}{b_m}
$$

当求极限 $\lim_{x \to 0}$ 时，可以通过保留最低阶的项来进行多项式因式分解。

此外，注意，在求极限 $\lim_{x \to \infty}$ 时，通常建议进行反向代换，即用 $\frac{1}{x}$ 替换所有出现的 $x$。

根据这些观察，我们可以得出结论，对于关于 $x$ 的二次多项式形式的多项式表达式，其极限在 $x \to 0$ 时很容易确定。

### 一般函数的多项式表达式

在确定了求多项式的极限的简洁性之后，一个自然的问题出现了：我们能否使用多项式来近似表示一般函数？毕竟，多项式可以具有任意数量的项，每个项都有自己的系数。这些系数充当函数的可调控制参数，使我们能够调节它们，试图使多项式尽可能接近一般函数。

我们将一般函数记为 $f(x)$，假设它可以用多项式来近似表示：
$$
f(x)=a_0+a_1x+a_2x^2+a_3x^3+\cdots+a_nx^n+\cdots \quad (1)
$$
现在的问题是如何确定这个多项式的系数。

很容易观察到 $a_0 = f(0)$，但是确定后续的系数似乎没有那么直接。我们希望上述方程对所有的 $x$ 值都成立，这使得我们可以同时对方程两边关于 $x$ 进行求导。这样做，我们得到：
$$
f'(x)=a_1+2a_2x+3a_3x^2+\cdots+na_nx^{n-1}+\cdots
$$
从中，我们可以轻松推断出 $a_1 = f'(0)$。类似地，我们可以以类似的方式确定其余的系数。

通过等式 $(1)$，同时对两边关于 $x$ 进行 $n$ 阶导数，我们得到：
$$
f^{(n)}(x)=n!a_n+\cdots
$$
令 $x = 0$，我们有：
$$
a_n=\frac{f^{(n)}(0)}{n!}
$$
因此，我们现在可以确定所有系数 $a_1, a_2, \ldots, a_n$（假设 $f(x)$ 具有 $n$ 阶导数）。因此，我们可以将 $f(x)$ 表示为：
$$
f(x)=\sum_{i=0}^{n}a_ix^i + R(x), \quad a_i=\frac{f^{(n)}(0)}{i!}
$$
这里，$R(x)$ 表示函数 $f(x)$ 相对于这个多项式近似的余项或误差。目前，我们不知道这个余项的确切形式。

### 泰勒定理

尽管我们还没有确定余项的确切形式，但泰勒定理给我们提供了一些保证（我在这里不会尝试证明）。让我们回顾一下**麦克劳林公式**和**皮亚诺余项**：

如果 $f(x)$ 在 $x = 0$ 处具有 $n$ 阶导数，那么在 $x$ 临近 $0$ 的地方，我们有：

$f(x) = \sum_{i=0}^{n} a_ix^i + o(x^n)$，其中 $a_i = \frac{f^{(n)}(0)}{i!}$。

这里，$o(x^n)$ 表示相对于 $x^n$ 来说更高阶的无穷小量，也就是说 $\lim_{x\to 0} \frac{o(x^n)}{x^n} = 0$。

泰勒定理涉及将麦克劳林公式中的 $x$ 替换为 $x - x_0$，其中 $x_0$ 表示 $x$ 的平移。在这里，我并没有严格区分泰勒定理和麦克劳林公式。暂时我们不会深入探讨拉格朗日余项。

美妙之处在于，基本函数以及一些幂函数和可变限积分构成了我们常见的极限问题的重要部分。由于这些函数具有无限可微的性质，我们可以将泰勒定理舒适地应用于它们。

## 常用的泰勒展开

因为在上一章已经提及，这里仅仅作展示：

1. **指数函数展开**：

指数函数的泰勒展开式为：
$$
e^x = 1 + x + \frac{x^2}{2!} + \frac{x^3}{3!} + \ldots = \sum_{n=0}^{\infty} \frac{x^n}{n!}
$$

1. **三角函数展开**：

常见三角函数的泰勒展开式为：

- 正弦函数：
  $$
  \sin(x) = x - \frac{x^3}{3!} + \frac{x^5}{5!} - \frac{x^7}{7!} + \ldots = \sum_{n=0}^{\infty} \frac{(-1)^n x^{2n+1}}{(2n+1)!}
  $$

- 余弦函数：
  $$
  \cos(x) = 1 - \frac{x^2}{2!} + \frac{x^4}{4!} - \frac{x^6}{6!} + \ldots = \sum_{n=0}^{\infty} \frac{(-1)^n x^{2n}}{(2n)!}
  $$

- 反正切展开：
  $$
  \arctan(x) = x - \frac{x^3}{3} + \frac{x^5}{5} - \frac{x^7}{7} + \ldots = \sum_{n=0}^{\infty} \frac{(-1)^n x^{2n+1}}{2n+1}
  $$

- 正切展开：
  $$
  \tan(x) = x + \frac{x^3}{3} + \frac{2x^5}{15} + \frac{17x^7}{315} + \ldots = \sum_{n=1}^{\infty} \frac{B_{2n} (-4)^n (1-4^n) x^{2n-1}}{(2n)!}
  $$

1. **自然对数展开**：

自然对数函数的泰勒展开式为：
$$
\ln(1+x) = x - \frac{x^2}{2} + \frac{x^3}{3} - \frac{x^4}{4} + \ldots = \sum_{n=1}^{\infty} \frac{(-1)^{n+1} x^n}{n}
$$

1. **几何级数**：

几何级数的泰勒展开式为：
$$
\frac{1}{1-x} = 1 + x + x^2 + x^3 + \ldots = \sum_{n=0}^{\infty} x^n, \quad |x| < 1
$$

1. **二项式展开**：

基于二项式定理的二项式展开式用于展开形如 $(a + b)^n$ 的表达式：
$$
(a + b)^n = \binom{n}{0} a^n b^0 + \binom{n}{1} a^{n-1} b^1 + \binom{n}{2} a^{n-2} b^2 + \ldots + \binom{n}{n-1} a^1 b^{n-1} + \binom{n}{n} a^0 b^n
$$

1. **误差函数展开**：

误差函数的泰勒展开式为：
$$
\mathrm{erf}(x) = \frac{2}{\sqrt{\pi}} \left(x - \frac{x^3}{3} + \frac{x^5}{10} - \frac{x^7}{42} + \ldots\right) = \sum_{n=0}^{\infty} \frac{(-1)^n x^{2n+1}}{n!(2n+1)}
$$

## 泰勒公式的强大之处

泰勒公式为我们揭示了替换和等价无穷小使用的局限性提供了宝贵的见解。

对于替换的情况，如果我们用 $cosx$ 替换 $x\to 0$，最初得到的值是1。然而，考虑到后续出现的诸如 $-\frac{1}{2!}x^2$ 的高阶项是至关重要的。忽略这些项可能导致错误的极限计算。

同样地，当考虑等价无穷小时，$x\to 0$ 时 $sinx$ 的无穷小等价确实是 $x$。然而，要认识到诸如 $-\frac{1}{3!}x^3$ 的高阶项的存在是至关重要的。忽略这些项可能导致极限计算中的不准确。

泰勒公式还加强了洛必达法则：
$$
L=\lim_{x \to 0}\frac{a_mx^m+a_{m+1}x^{m+1}+\cdots}{b_mx^m+b_{m+1}x^{m+1}+\cdots}
\overset{\text{洛必达法则}}{\Longrightarrow  }\lim_{x \to 0}\frac{ma_mx^{m-1}+(m+1)a_{m+1}x^m+\cdots}{mb_mx^{m-1}+(m+1)b_{m+1}x^m+\cdots}
=\cdots
$$
从这个角度来看，洛必达法则涉及到逐步简化分子和分母的过程，类似于一场对局。相比之下，泰勒公式允许将分子和分母都分解成多项式，类似于对函数的X光扫描，一目了然地提供了整体视角。

## 泰勒公式的应用

在应用泰勒公式计算极限时，包含皮亚诺余项是至关重要的。这种包含使你能够评估你的近似的准确性。我们来看一个例子：
$$
\lim_{x\to 0}\frac{e^x-1-x}{x^2}=\lim_{x\to 0 }\frac{(1+x+\frac{1}{2!}x^2+o(x^2))-1-x}{x^2}=\lim_{x\to0}\frac{\frac{1}{2}x^2+o(x^2)}{x^2}=\frac{1}{2}
$$
替换、等价无穷小和洛必达法则确实是有用而简洁的技巧。然而，重要的是要谨慎使用它们，而不是不加选择地使用。当对它们的适用性不确定时，最好使用泰勒公式代替。

通过使用泰勒公式，你可以清楚地了解这些替代方法可以在何时使用，从而避免潜在的不准确性。

### 四则运算

1. 计算极限 $\lim_{x\to0}\frac{e^x-\cos x-x}{x^2}$。

由于分母是二阶的，我们也将分子展开到二阶：
$$
\begin{eqnarray} 
L&=&\lim_{x\to 0}\frac{(1+x+\frac{1}{2}x^2+o(x^2))-(1-\frac{1}{2}x^2+o(x^2))-x}{x^2}\\
~&=&\lim_{x\to 0}\frac{\frac{1}{2}x^2+\frac{1}{2}x^2+o(x^2)}{x^2}\\
~&=&1
\end{eqnarray}
$$


2. 计算极限 $\lim_{x\to 0}\frac{3\sin x+x^2\cos{\frac{1}{x}}}{(1+\cos x)\ln(1+x)}$。

分子有振荡行为，这可能不会影响极限。我们首先利用之前的结论简化分母，因为我们要因式分解并只保留最低阶的项：
$$
\begin{eqnarray} 
L&=&\lim_{x\to 0}\frac{3sinx+x^2cos{\frac{1}{x}}}{(1+1+o(x))(x+o(x))}\\
&=&\lim_{x\to0}\frac{3sinx+x^2cos{\frac{1}{x}}}{2x}
\end{eqnarray}
$$
现在，我们可以将极限计算分为两部分：
$$
L=\lim_{x\to 0}\frac{3sinx}{2x}+\frac{x}{2}cos{\frac{1}{x}}=\frac{3}{2}+0=\frac{3}{2}
$$


1. 计算极限 $L=\lim_{x\to 0}\frac{x\sin x\cos x-x^2}{e^x\ln(1+x)+\ln(1-x)}$

这个问题涉及到多项式的乘法，可能有些繁琐。如果不确定要展开多少项，可以先展开两项并包含余项。如果展开不够准确，可以继续展开。

由于分子看起来更容易处理，我们首先展开分子以确定展开的阶数：
$$
\begin{eqnarray} 
xsinxcosx-x^2&=&x(x-\frac{1}{3!}x^3+o(x^3))(1-\frac{1}{2!}x^2+o(x^2))-x^2\\
&=&x^2-\frac{1}{2}x^4+o(x^4)-\frac{1}{6}x^4+o(x^4)-x^2\\
&=&-\frac{2}{3}x^4+o(x^4)
\end{eqnarray}
$$
注意，展开中的大于 $x^4$ 的项可以合并为 $o(x^4)$，无需计算每一项。这给出了一个带有 $x$ 的四阶无穷小。由于四阶项的系数非零，这个展开足够了。如果系数为零，我们将继续展开。接下来，我们需要将分母展开到四阶（如果分子和分母的阶数不同，极限要么是0，要么是无穷大，这很容易确定，通常不会遇见这种题）。

对于分母：
$$
e^x\ln(1+x)+\ln(1-x)=(1+x+\frac{1}{2}x^2+o(x^2))(x-\frac{1}{2}x^2+o(x^2))+(-x-\frac{1}{2}x^2+o(x^2))
$$
很明显，这个展开是不够的，因为出现的 $o(x^2)$ 的形式不确定，可能会影响极限。我们通过以下方式增加展开的准确性：
$$
\begin{eqnarray} &&e^x\ln(1+x)+\ln(1-x)\\ &=&(1+x+\frac{1}{2}x^2+\frac{1}{6}x^3+o(x^3))(x-\frac{1}{2}x^2+\frac{1}{3}x^3-\frac{1}{4}x^4+o(x^4))+(-x-\frac{1}{2}x^2-\frac{1}{3}x^3-\frac{1}{4}x^4+o(x^4))\\ &=&x-\frac{1}{2}x^2+\frac{1}{3}x^3-\frac{1}{4}x^4+x^2-\frac{1}{2}x^3+\frac{1}{3}x^4+\frac{1}{2}x^3-\frac{1}{4}x^4+\frac{1}{6}x^4+o(x^4)-x-\frac{1}{2}x^2-\frac{1}{3}x^3-\frac{1}{4}x^4+o(x^4)\\ &=&(-\frac{1}{4}+\frac{1}{3}-\frac{1}{4}+\frac{1}{6}-\frac{1}{4})x^4+o(x^4)\\ &=&-\frac{1}{4}x^4+o(x^4) \end{eqnarray}
$$
总结一下：
$$
L=\lim_{x\to 0}\frac{-\frac{2}{3}x^4+o(x^4)}{-\frac{1}{4}x^4+o(x^4)}=\frac{8}{3}
$$

### 复合函数题

在使用泰勒公式时，考虑整个函数逼近零点是至关重要的。

1. 计算极限 $L=\lim _{x \rightarrow 0} \frac{(1-\cos x)(x-\ln (1+\tan x))}{\sin ^{4} x}$。

首先对分子和分母进行因式分解是很好的处理方法，但是分子中第二个项的因式分解会带来一些挑战。我们考虑将 $tanx$ 作为一个整体展开。
$$
L=\lim_{x\to0}\frac{\frac{1}{2}x^2(x-(tanx-\frac{1}{2}(tanx)^2+o((tanx)^2)))}{x^4}
$$
由于我们知道 $\tan x=x+o(x)$，我们可以代入 $(\tan x)^2=x^2+o(x^2)$，得到：
$$
L=\lim_{x\to 0}\frac{x-tanx+\frac{1}{2}x^2+o(x^2)}{2x^2}=\lim_{x\to 0}\frac{x-tanx}{2x^2}+\frac{1}{4}
$$
根据第2部分的结果，我们可以确定 $x-\tan x$ 是一个三阶无穷小。因此：
$$
L=0+\frac{1}{4}=\frac{1}{4}
$$


1. 计算极限 $L=\lim_{x\to0}\frac{2\ln(\cos x)+x^2}{\sin^2 x-x^2}$。

我们可以通过以下方法更有效地处理分母：
$$
\begin{eqnarray} 
sin^2x-x^2&=&(sinx+x)(sinx-x)\\
		  &=&2x(-\frac{1}{3!}x^3+o(x^3))\\
		  &=&-\frac{1}{3}x^4+o(x^4)
\end{eqnarray}
$$
现在，我们来展开分子到四阶，考虑整个表达式 $(\cos x - 1)$：
$$
\begin{eqnarray} 2\ln(\cos x)+x^2 &=& 2\ln(1+\cos x-1)+x^2 \\ &=& 2((\cos x-1)-\frac{1}{2}(\cos x-1)^2+o((\cos x-1)^2))+x^2 \\ &=& 2(-\frac{1}{2}x^2+\frac{1}{4!}x^4+o(x^4)-\frac{1}{2}(-\frac{1}{2}x^2+o(x^2))^2+o(x^4))+x^2 \\ &=& 2(-\frac{1}{2}x^2+\frac{1}{24}x^4-\frac{1}{8}x^4+o(x^4))+x^2 \\ &=& -\frac{1}{6}x^4+o(x^4) \end{eqnarray}
$$
因此，
$$
L=\lim_{x\to 0}\frac{-\frac{1}{6}x^4+o(x^4)}{-\frac{1}{3}x^4+o(x^4)}=\frac{1}{2}
$$

### 幂指函数问题

处理形如 $f(x)^{g(x)}$ 的幂指函数时，常常需要取对数并利用近似 $\ln(1+\alpha(x))=\alpha(x)+o(\alpha(x))$。

1. 计算极限 $L=\lim_{x\to 0}(\frac{x}{\sin x}^{\frac{1}{x^2}})$。

为了简化表达式，我们可以取自然对数：
$$
\begin{eqnarray} \ln L&=&\lim_{x\to 0}\frac{1}{x^2}\ln{\frac{x}{\sin x}}\\ &=&\lim_{x\to 0}\frac{1}{x^2}\ln(1+\frac{x}{\sin x}-1)\\ &=&\lim_{x\to 0}\frac{1}{x^2}(\frac{x}{\sin x}-1)\\ &=&\lim_{x\to 0}\frac{x-\sin x}{x^2\sin x}\\ &=&\lim_{x\to 0}\frac{x-(x-\frac{1}{3!}x^3+o(x^3))}{x^3}\\ &=&\frac{1}{6} \end{eqnarray}
$$
对两边进行指数运算，我们得到：
$$
L=e^{\frac{1}{6}}
$$
